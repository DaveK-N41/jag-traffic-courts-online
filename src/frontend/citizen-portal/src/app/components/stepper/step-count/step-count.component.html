<app-stepper-page>
  <app-page-header>
    <ng-container subHeader>
      <div class="row mt-2">
        <div class="col-md-8">
          <small class="d-block"> Description of offence </small>
          <strong>{{ offenceDescription.value | titlecase }}</strong>
        </div>
        <div class="col-md-4">
          <small class="d-block">Offence amount</small>
          <strong>{{
            ticketedAmount.value
            | currency: "CAD":"symbol-narrow":"1.2-2":defaultLanguage
            }}</strong>
        </div>
      </div>
    </ng-container>
  </app-page-header>

  <form (ngSubmit)="onSubmit()"
        [formGroup]="form"
        novalidate>
    <section>
      <div class="row">
        <div class="col">
          <label class="w-100">
            What would you to like to action on this count?
          </label>
          <mat-radio-group formControlName="offenceAgreementStatus">
            <mat-radio-button value="REDUCTION">
              <span class="wrap-mat-radio-label">
                I agree I committed this offence and I would like to request a
                fine reduction and/or time to pay for this count.
              </span>
              <span matTooltip="Ask for a fine reduction or more time to pay for the count."
                    #tooltip3="matTooltip">
                <mat-icon>info</mat-icon>
              </span>
            </mat-radio-button>
            <mat-radio-button value="DISPUTE">
              <span class="wrap-mat-radio-label">
                I do not agree that I committed this offence and I would like to
                dispute this count.
              </span>
              <span matTooltip="Go to court and dispute this count."
                    #tooltip4="matTooltip">
                <mat-icon>info</mat-icon>
              </span>
            </mat-radio-button>
            <mat-error *ngIf="
                (offenceAgreementStatus.dirty ||
                  offenceAgreementStatus.touched) &&
                offenceAgreementStatus.invalid &&
                offenceAgreementStatus.errors.required
              ">
              {{ "error.required" | translate }}
            </mat-error>
          </mat-radio-group>
        </div>
      </div>
       <div class="row mt-4" *ngIf="!isShowCheckbox">
        <label class="w-100" *ngIf="offenceAgreementStatus?.value !== 'PAY'" >
          Please provide additional selections below:
        </label>
         <div *ngIf="offenceAgreementStatus.value == 'REDUCTION'">
          <mat-checkbox formControlName="reductionAppearInCourt" color="primary" class="w-100"> I would like to request a fine reduction on this count.</mat-checkbox>
          <mat-checkbox formControlName="reductionAppearInCourtDoNot" color="primary" class="w-100"> I would like to request more time to pay on this count.</mat-checkbox>
        
        </div>
        
        <mat-checkbox formControlName="reductionAppearInCourtDo" *ngIf="offenceAgreementStatus?.value !== 'PAY'" color="primary" class="w-100"> I would like to appear in court in person and speak to a judicial judge about this count.<mat-icon>info</mat-icon></mat-checkbox>
        
        <div style="font-size: 20px; color: red;">
          {{isSelectedChekcError}}
        </div>
        <div *ngIf="allowApplyToAllCounts.value">
          <mat-checkbox formControlName="_applyToAllCounts" color="primary" *ngIf="firstOffence.value"
            class="w-100 mt-2">Apply these selections to all counts on this violation ticket.</mat-checkbox>
        </div>
      </div>

      <div class="row"
           *ngIf="allowApplyToAllCounts.value && offenceAgreementStatus.value === 'DISPUTE' && firstOffence.value">
        <mat-checkbox formControlName="_applyToAllCounts"
                      color="primary"
                      class="w-100 mt-4">Apply this selection to all counts on this violation ticket.</mat-checkbox>
      </div>
    </section>
  </form>

  <div class="col mt-4"
       *ngIf="
      offenceAgreementStatus.value === 'REDUCTION'" &&
      reductionAppearInCourt.value === false
    >
    <app-alert type="warning"
               icon="warning">
      <ng-container #alertContent
                    class="alert-content">
        <strong>You must provide written reasons in the Additional Information area of the form below for this option. If you do choose to appear in court to discuss you will not need to provide this information until the court hearing date. <br><br>

          If you provide written reasons, you will be notified in writing by the Court if your application was successful.</strong>
      </ng-container>
    </app-alert>
  </div>

  <div class="col mt-4"
       *ngIf="
      (offenceAgreementStatus.value === 'REDUCTION' &&
        reductionAppearInCourtDo.value)
    ">
    <app-alert type="warning"
               icon="warning">
      <ng-container #alertContent
                    class="alert-content">
                  <strong>A Notice of Hearing will be mailed to you â€“ it will have the date, time and location of your hearing.  <br><br>

                    If you fail to appear before the provincial court on your hearing date you will be found guilty and the full ticketed amount must be paid immediately.</strong>
      </ng-container>
    </app-alert>
  </div>
  <div class="col mt-4"
  *ngIf="
 offenceAgreementStatus.value === 'DISPUTE'
">
<app-alert type="warning"
          icon="info">
 <ng-container #alertContent
               class="alert-content">
             <strong>If you fail to appear before the provincial court on your hearing date you will be found guilty and the full ticketed amount
              must be paid immediately.
              </strong>
 </ng-container>
</app-alert>
</div>
<div class="col mt-4"
  *ngIf="
 (offenceAgreementStatus.value === 'DISPUTE' && ticketName === ticketTypesEnum.CAMERA_TICKET)
">
<app-alert type="warning"
          icon="info">
 <ng-container #alertContent
               class="alert-content">
             <strong>If you dispute the ticket, an intersection safety camera officer will always appear in court to explain the offence and
              provide evidence.</strong>
 </ng-container>
</app-alert>
</div>
  <app-stepper-footer (save)="onSubmit()"
                      (back)="onBack()"
                      [secondaryActionButtonIcon]="previousButtonIcon"
                      [secondaryActionButtonKey]="previousButtonKey"
                      [saveButtonKey]="saveButtonKey"
                      [hasSecondaryAction]="true">
  </app-stepper-footer>
</app-stepper-page>
